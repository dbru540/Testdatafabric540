parameters{
	Filename as string ("contact_ggef_ESGCV - PARIS.csv"),
	MyDSO_Account as string ("ESGCV - PARIS")
}
source(output(
		{Code client *} as string,
		Role as string,
		{Contact pour le recouvrement} as string,
		{Nom*} as string,
		Prenom as string,
		Telephone as string,
		{E-mail} as string,
		{Civilité} as string,
		{Telephone portable} as string,
		Commentaires as string
	),
	allowSchemaDrift: false,
	validateSchema: false,
	ignoreNoFilesFound: false,
	wildcardPaths:[(concat('Working_Directory/IN_D365_Files/', $Filename))]) ~> ContactD365
source(output(
		{Code client *} as string,
		Role as string,
		{Contact pour le recouvrement} as string,
		{Nom*} as string,
		Prenom as string,
		Telephone as string,
		{E-mail} as string,
		{civilité} as string,
		{Telephone portable} as string,
		Commentaires as string
	),
	allowSchemaDrift: false,
	validateSchema: false,
	ignoreNoFilesFound: false,
	wildcardPaths:[(concat('Working_Directory/IN_Sage_Files/', $Filename))]) ~> ContactSage
source(output(
		{Code client *} as string,
		{Montant initial HT} as string,
		{Montant initial TTC *} as string,
		{Montant restant HT} as string,
		{Montant restant TTC} as string,
		{Nom affaire} as string,
		{Devise *} as string,
		{Date echeance *} as string,
		{Date emission *} as string,
		{Date commande} as string,
		{Date paiement} as string,
		{Type de piece ERP} as string,
		{Numero dossier} as string,
		{Numero piece *} as string,
		{Numero commande} as string,
		{Acteur ADV} as string,
		Commercial as string,
		{Sens de l'écriture} as string,
		{Type de piece *} as string,
		{Identifiant piece unique} as string,
		{Champ personnalisé #1} as string,
		{Champ personnalisé #2} as string,
		{Champ personnalisé #3} as string,
		{Champ personnalisé #4} as string,
		{Champ personnalisé #5} as string,
		{Champ personnalisé #6} as string
	),
	allowSchemaDrift: false,
	validateSchema: false,
	ignoreNoFilesFound: false,
	wildcardPaths:['Working_Directory/IN_D365_Files/piece_ggef_ESGCV - PARIS.csv']) ~> PieceD365
source(output(
		{Code client *} as string,
		{Montant initial HT} as string,
		{Montant initial TTC *} as string,
		{Montant restant HT} as string,
		{Montant restant TTC} as string,
		{Nom affaire} as string,
		{Devise *} as string,
		{Date echeance *} as string,
		{Date emission *} as string,
		{Date commande} as string,
		{Date paiement} as string,
		{Type de piece ERP} as string,
		{Numero dossier} as string,
		{Numero piece *} as string,
		{Numero commande} as string,
		{Acteur ADV} as string,
		Commercial as string,
		{Sens de l'écriture} as string,
		{Type de piece *} as string,
		{Identifiant piece unique} as string,
		{Champ personnalisé #1} as string,
		{Champ personnalisé #2} as string,
		{Champ personnalisé #3} as string,
		{Champ personnalisé #4} as string,
		{Champ personnalisé #5} as string,
		{Champ personnalisé #6} as string
	),
	allowSchemaDrift: false,
	validateSchema: false,
	ignoreNoFilesFound: false,
	wildcardPaths:['Working_Directory/IN_Sage_Files/piece_ggef_ESGCV - PARIS.csv']) ~> PieceSage
PieceD365 aggregate(groupBy({Code client *}),
	Count = count({Code client *})) ~> ClientExists
ClientAll, ClientExists exists(ClientAll@{Code client *} == ClientExists@{Code client *},
	negate:true,
	broadcast: 'auto')~> MissingClients
PieceSage aggregate(groupBy({Code client *}),
	Count = count({Code client *})) ~> ClientAll
ContactSage, MissingClients exists(ContactSage@{Code client *} == ClientAll@{Code client *},
	negate:false,
	broadcast: 'auto')~> MissingContacts
ContactD365, MissingContacts union(byName: true)~> UnionMissingContacts
UnionMissingContacts sink(allowSchemaDrift: true,
	validateSchema: false,
	format: 'delimited',
	fileSystem: 'interface-mydso',
	folderPath: 'Working_Directory/OUT_MyDSO__Temp_Files',
	rowDelimiter: ('\r\n'),
	columnDelimiter: ';',
	escapeChar: '\"',
	quoteChar: '\"',
	encodingName: 'WINDOWS-1252',
	columnNamesAsHeader: true,
	partitionFileNames:[($Filename)],
	umask: 0022,
	preCommands: [],
	postCommands: [],
	skipDuplicateMapInputs: true,
	skipDuplicateMapOutputs: true,
	partitionBy('hash', 1)) ~> ExportFile